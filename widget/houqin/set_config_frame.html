<!DOCTYPE HTML>
<html>
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="maximum-scale=1.0,minimum-scale=1.0,user-scalable=0,width=device-width,initial-scale=1.0"/>
    <title>APP</title>
    <link rel="stylesheet" type="text/css" href="../css/aui.css" />
</head>
<style type="text/css">
body {
    height: auto;
}
.aui-content-padded {
    padding-top: 15px;
}
.aui-btn-block {
    margin-bottom: 15px;
}
.aui-nav{
    background-color: #3e6491;
    color: #ffffff;
    text-align: center;
    line-height: 50px;
}
</style>
<body>
    <div class="aui-content aui-card aui-noborder" style="padding-top:20px;">
        <p class="aui-padded-10 aui-text-danger">
            本设置能让你更好地管理公司，使公司走上良性循环发展的道路！<br>
            请根据公司具体情况做修改！
        </p>       
        <div class="aui-form">
            <div class="aui-input-row">
                <span class="aui-input-addon">经理业务提成（元）</span>
                <input type="number" class="aui-input" id="jingliYewuTicheng" placeholder="经理接待客人每单分得提成，建议范围（10~20）" />
            </div>
            <div class="aui-input-row">
                <span class="aui-input-addon">经理预约提成（元）</span>
                <input type="number" class="aui-input" id="jingliYuyueTicheng" placeholder="客户来到前台确认后，经理分得提成，建议范围（30~50）" />
            </div>
            <div class="aui-input-row">
                <span class="aui-input-addon">经理每日目标工作量（单）</span>
                <input type="number" class="aui-input" id="jingliMubiao" placeholder="经理每日接待目标工作量，建议范围（7~10）"/>
            </div>
            <div class="aui-input-row aui-hidden">
                <span class="aui-input-addon">经理买钟单价（元）</span>
                <input type="number" class="aui-input" id="jingliMaizhong" placeholder="经理买钟1小时单价，建议范围（50~80）"/>
            </div>
            <div class="aui-input-row">
                <span class="aui-input-addon">技师预约提成（元）</span>
                <input type="number" class="aui-input" id="jishiYuyueTicheng" placeholder="客户来到前台确认后，技师分得提成，建议范围（20~40）"/>
            </div>
            <div class="aui-input-row">
                <span class="aui-input-addon">技师每日目标工作量（单）</span>
                <input type="number" class="aui-input" id="jishiMubiao" placeholder="技师每日接待目标工作量，建议范围（3~5）"/>
            </div>
            <div class="aui-input-row">
                <span class="aui-input-addon">技师买钟单价（元）</span>
                <input type="number" class="aui-input" id="jishiMaizhong" placeholder="技师买钟1小时单价，建议范围（80~150）"/>
            </div>
            <div class="aui-input-row">
                <span class="aui-input-addon">公司每日目标营业额（元）</span>
                <input type="number" class="aui-input" id="companyYingye" placeholder="公司每日目标营业额，建议范围（5000~15000）"/>
            </div>
        </div>
    </div>
    <footer class="aui-nav" id="aui-footer">
        <div class="aui-col-xs-12" id="saveBtn">
            <button class="aui-btn aui-btn-danger aui-btn-block" tapmode onclick="saveCheck()">确定参数</button>
        </div>
    </footer>
</body>
<script type="text/javascript" src="../script/api.js" ></script>
<script type="text/javascript" src="../script/mis.js" ></script>
<script type="text/javascript" src="../script/function.js" ></script>
<script type="text/javascript">
var companyId = $api.getStorage('companyId');
var addAction = 'systemConfig';
var getAction = 'systemConfigByQiantai';
var jingliYewuTicheng,jingliYuyueTicheng,jingliMubiao,jishiYuyueTicheng,jishiMubiao,jingliMaizhong,jishiMaizhong,companyYingye;

function saveCheck(){
    var canSend = 1;
    jingliYewuTicheng = $api.val($api.byId('jingliYewuTicheng'));
    jingliYuyueTicheng = $api.val($api.byId('jingliYuyueTicheng'));
    jingliMubiao = $api.val($api.byId('jingliMubiao'));
    jishiYuyueTicheng = $api.val($api.byId('jishiYuyueTicheng'));
    jishiMubiao = $api.val($api.byId('jishiMubiao'));
    jingliMaizhong = $api.val($api.byId('jingliMaizhong'));
    jishiMaizhong = $api.val($api.byId('jishiMaizhong'));
    companyYingye = $api.val($api.byId('companyYingye'));
    
    if(jingliYewuTicheng == "" || jingliYuyueTicheng == '' ||  jingliMubiao == '' ||  jishiYuyueTicheng == '' ||  jishiMubiao == '' ||  jishiMaizhong == '' ||  companyYingye == ''){
        api.toast({
            msg: '请务必将全部信息填充完整'
        });
        canSend = 0;
    }
    if(canSend == 1){
        saveInfo();
    }
}
function saveInfo(){
    api.ajax({
        url: appUrl+'Add/' + addAction,
        method: 'post',
        data: {
            values: {
                jingli_yewu_ticheng:jingliYewuTicheng,
                jingli_yuyue_ticheng:jingliYuyueTicheng,
                jingli_mubiao:jingliMubiao,
                jingli_maizhong:jingliMaizhong,
                jishi_yuyue_ticheng:jishiYuyueTicheng,
                jishi_mubiao:jishiMubiao,
                jishi_maizhong:jishiMaizhong,
                company_yingye:companyYingye,
                company_id:companyId
            },
            files: { 
                fileName: 'filePath'
            }
        }
    }, function(ret, err) {
        if (ret) {
            if(ret.has == 1){
                alert('保存参数成功');
                api.closeWin();
            }
        } else {
            api.toast({
                msg: '网络错误'
            });
        }
    });
}
function bulidPageById(){
    api.ajax({
        url: appUrl+'Get/'+getAction,
        method: 'post',
        data: {
            values: { 
                company_id: companyId
            },
            files: { 
                fileName: 'filePath'
            }
        }
    }, function(ret, err) {
        if (ret) {
            if(ret.has == 1){
                pageJson = ret.data;
                changePage();
            }
        } else {
            api.toast({
                msg: '网络错误'
            });
        }
    });
}

function changePage(){
    jingliYewuTicheng = pageJson.jingli_yewu_ticheng;
    jingliYuyueTicheng = pageJson.jingli_yuyue_ticheng;
    jingliMubiao = pageJson.jingli_mubiao;
    jingliMaizhong = pageJson.jingli_maizhong;
    jishiYuyueTicheng = pageJson.jishi_yuyue_ticheng;
    jishiMubiao = pageJson.jishi_mubiao;
    jishiMaizhong = pageJson.jishi_maizhong;
    companyYingye = pageJson.company_yingye;
    $api.val($api.byId('jingliYewuTicheng'), jingliYewuTicheng);
    $api.val($api.byId('jingliYuyueTicheng'), jingliYuyueTicheng);
    $api.val($api.byId('jingliMubiao'), jingliMubiao);
    $api.val($api.byId('jingliMaizhong'), jingliMaizhong);
    $api.val($api.byId('jishiYuyueTicheng'), jishiYuyueTicheng);
    $api.val($api.byId('jishiMubiao'), jishiMubiao);
    $api.val($api.byId('jishiMaizhong'), jishiMaizhong);
    $api.val($api.byId('companyYingye'), companyYingye);
    $api.html($api.byId('saveButton'), '修改参数');
}
apiready = function(){
    api.parseTapmode();
    bulidPageById()
}
        
</script>
</html>